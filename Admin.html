<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* --- Style ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --- */
        * { box-sizing: border-box; font-family: 'Sarabun', sans-serif; }
        body { margin: 0; background-color: #f4f7f6; display: flex; height: 100vh; overflow: hidden; }
        .sidebar { width: 260px; background: #2c3e50; color: white; display: flex; flex-direction: column; padding: 20px 0; transition: 0.3s; }
        .sidebar-header { text-align: center; padding: 0 20px 20px; border-bottom: 1px solid #34495e; font-size: 1.2rem; font-weight: 600; }
        .sidebar-menu { list-style: none; padding: 0; margin: 20px 0; flex-grow: 1; }
        .sidebar-menu li { padding: 15px 25px; cursor: pointer; transition: 0.3s; display: flex; align-items: center; }
        .sidebar-menu li:hover { background: #34495e; }
        .sidebar-menu li.active { background: #764ba2; border-left: 5px solid #fff; }
        .sidebar-menu li span { margin-left: 10px; }
        .main-content { flex-grow: 1; overflow-y: auto; padding: 30px; background: #f4f7f6; }
        .header-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .clock-container { background: white; padding: 10px 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; align-items: center; gap: 12px; border: 1px solid #e0e0e0; }
        .clock-label { font-size: 0.85rem; color: #666; }
        .clock-time { font-size: 1.2rem; color: #764ba2; font-weight: 600; min-width: 80px; }
        .content-card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 25px; }
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: #f8f9fa; color: #333; font-weight: 600; }
        .status-pill { padding: 5px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; min-width: 90px; display: inline-block; text-align: center; }
        .status-pending { background: #fff3cd; color: #856404; }
        .status-success { background: #d4edda; color: #155724; }
        .btn-logout { padding: 15px 25px; background: #c0392b; color: white; text-align: center; cursor: pointer; border: none; font-weight: 600; }
        .btn-add { background: #2ecc71; color: white; border: none; padding: 12px 25px; border-radius: 6px; cursor: pointer; font-size: 1rem; width: 100%; }
        .btn-toggle-status { background: #3498db; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; transition: 0.2s; }
        .btn-toggle-status:hover { background: #2980b9; }
        .btn-delete { background: #e74c3c; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; margin-left: 5px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; color: #444; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 1rem; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.55); backdrop-filter: blur(3px); align-items: center; justify-content: center; }
        .modal-content { background: white; padding: 30px; border-radius: 15px; width: 90%; max-width: 400px; text-align: center; }
        .modal-buttons { display: flex; gap: 10px; justify-content: center; margin-top: 25px; }
        .btn-confirm { background: #c0392b; color: white; border: none; padding: 10px 25px; border-radius: 6px; cursor: pointer; }
        .btn-cancel { background: #eee; color: #333; border: none; padding: 10px 25px; border-radius: 6px; cursor: pointer; }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="sidebar-header">üõ† Admin Panel</div>
    <ul class="sidebar-menu">
        <li class="active" onclick="showPage('dashboard', event)">üè† <span>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span></li>
        <li onclick="showPage('repair-status', event)">üìã <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°</span></li>
        <li onclick="showPage('add-job', event)">‚ûï <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°</span></li>
    </ul>
    <div class="btn-logout" onclick="openLogoutModal()">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</div>
</div>

<div class="main-content">
    <div class="header-bar">
        <h2 id="page-title">Dashboard / ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</h2>
        <div class="clock-container">
            <div class="clock-label">üìÖ <span id="current-date">-</span></div>
            <div style="width: 1px; height: 20px; background: #eee;"></div>
            <div class="clock-time" id="digital-clock">00:00:00</div>
        </div>
    </div>

    <div id="dashboard" class="page-content">
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
            <div class="content-card" style="border-left: 5px solid #764ba2;">
                <p style="color: #666;">‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                <h3 id="total-count">0</h3> 
            </div>
            <div class="content-card" style="border-left: 5px solid #f1c40f;">
                <p style="color: #666;">‡∏£‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</p>
                <h3 id="pending-count">0</h3>
            </div>
            <div class="content-card" style="border-left: 5px solid #2ecc71;">
                <p style="color: #666;">‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</p>
                <h3 id="success-count">0</h3>
            </div>
        </div>
    </div>

    <div id="repair-status" class="page-content" style="display:none;">
        <div class="content-card">
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th style="width: 60px; text-align: center;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á</th>
                            <th>‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á / ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th> <th>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</th>
                            <th>‡∏≠‡∏≤‡∏Å‡∏≤‡∏£</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        </tr>
                    </thead>
                    <tbody id="repair-data-table"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="add-job" class="page-content" style="display:none;">
        <div class="content-card" style="max-width: 600px; margin: auto;">
            <h3 style="margin-top: 0; color: #764ba2;">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</h3>
            <hr style="border: 0; border-top: 1px solid #eee; margin-bottom: 20px;">
            <form id="jobForm">
                <div class="form-group">
                    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á (day)</label>
                    <input type="date" id="day" required>
                </div>
                <div class="form-group">
                    <label>‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á (name)</label>
                    <input type="text" id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required>
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (phone)</label> <input type="tel" id="phone" placeholder="0xx-xxx-xxxx" required>
                </div>
                <div class="form-group">
                    <label>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (EQM)</label>
                    <input type="text" id="EQM" placeholder="‡πÄ‡∏ä‡πà‡∏ô Notebook, Printer" required>
                </div>
                <div class="form-group">
                    <label>‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ (sym)</label>
                    <input type="text" id="sym" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô" required>
                </div>
                <div class="form-group">
                    <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
                    <select id="status">
                        <option value="pending">‡∏£‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</option>
                        <option value="success">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</option>
                    </select>
                </div>
                <button type="submit" class="btn-add">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </form>
        </div>
    </div>
</div>

<div id="logoutModal" class="modal">
    <div class="modal-content">
        <div style="font-size: 3rem; margin-bottom: 15px;">üèÉ‚Äç‚ôÇÔ∏è</div>
        <h3>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö?</h3>
        <p style="color: #666;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
        <div class="modal-buttons">
            <button class="btn-cancel" onclick="closeLogoutModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button class="btn-confirm" onclick="confirmLogout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
    </div>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('repair_db')) || [];

    function showPage(pageId, event) {
        document.querySelectorAll('.page-content').forEach(p => p.style.display = 'none');
        document.querySelectorAll('.sidebar-menu li').forEach(l => l.classList.remove('active'));
        document.getElementById(pageId).style.display = 'block';
        if(event) event.currentTarget.classList.add('active');

        const titleMap = {
            'dashboard': 'Dashboard / ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å',
            'repair-status': '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
            'add-job': '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡πÉ‡∏´‡∏°‡πà'
        };
        document.getElementById('page-title').innerText = titleMap[pageId];
    }

    document.getElementById('jobForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const newJob = {
            Num: db.length > 0 ? db[db.length - 1].Num + 1 : 1,
            day: document.getElementById('day').value,
            name: document.getElementById('name').value,
            phone: document.getElementById('phone').value, // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£
            EQM: document.getElementById('EQM').value,
            sym: document.getElementById('sym').value,
            status: document.getElementById('status').value
        };

        db.push(newJob);
        saveAndRefresh();
        this.reset();
        showPage('repair-status');
        alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
    });

    function toggleStatus(num) {
        const index = db.findIndex(item => item.Num === num);
        if (index !== -1) {
            db[index].status = db[index].status === 'success' ? 'pending' : 'success';
            saveAndRefresh();
        }
    }

    function deleteJob(num) {
        if(confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà ' + num + ' ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
            db = db.filter(item => item.Num !== num);
            saveAndRefresh();
        }
    }

    function saveAndRefresh() {
        localStorage.setItem('repair_db', JSON.stringify(db));
        renderTable();
        renderDashboard();
    }

    function renderTable() {
        const tbody = document.getElementById('repair-data-table');
        tbody.innerHTML = '';

        db.forEach(item => {
            const row = document.createElement('tr');
            const isSuccess = item.status === 'success';
            const statusClass = isSuccess ? 'status-success' : 'status-pending';
            const statusText = isSuccess ? '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô' : '‡∏£‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á';
            const btnText = isSuccess ? '‚Ü©Ô∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏´‡∏°‡πà' : '‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à';

            row.innerHTML = `
                <td style="text-align: center;">${item.Num}</td>
                <td>${item.day}</td>
                <td>
                    <strong>${item.name}</strong><br>
                    <small style="color: #7f8c8d;">üìû ${item.phone || '-'}</small>
                </td>
                <td>${item.EQM}</td>
                <td>${item.sym}</td>
                <td><span class="status-pill ${statusClass}">${statusText}</span></td>
                <td>
                    <button class="btn-toggle-status" onclick="toggleStatus(${item.Num})">${btnText}</button>
                    <button class="btn-delete" onclick="deleteJob(${item.Num})">‡∏•‡∏ö</button>
                </td>
            `;
            tbody.appendChild(row);
        });
    }

    function renderDashboard() {
        document.getElementById('total-count').innerText = db.length;
        document.getElementById('pending-count').innerText = db.filter(i => i.status === 'pending').length;
        document.getElementById('success-count').innerText = db.filter(i => i.status === 'success').length;
    }

    function updateClock() {
        const now = new Date();
        document.getElementById('digital-clock').innerText = now.toLocaleTimeString('th-TH');
        document.getElementById('current-date').innerText = now.toLocaleDateString('th-TH', {day:'numeric', month:'short', year:'numeric'});
    }

    function openLogoutModal() { document.getElementById("logoutModal").style.display = "flex"; }
    function closeLogoutModal() { document.getElementById("logoutModal").style.display = "none"; }
    
    // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Index.html ‡πÄ‡∏õ‡πá‡∏ô index.html
    function confirmLogout() { window.location.href = "index.html"; }

    setInterval(updateClock, 1000);
    updateClock();
    saveAndRefresh();
</script>

</body>
</html>
